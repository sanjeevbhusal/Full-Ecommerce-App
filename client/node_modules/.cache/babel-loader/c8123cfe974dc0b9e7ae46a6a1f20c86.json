{"ast":null,"code":"import _objectSpread from\"C:/Users/Acer/Desktop/Projects/React/ecommerce-app/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\Acer\\\\Desktop\\\\Projects\\\\React\\\\ecommerce-app\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(authenticateUser),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(signUpSuccess),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(signUp),_marked4=/*#__PURE__*/_regeneratorRuntime.mark(signInWithGoogle),_marked5=/*#__PURE__*/_regeneratorRuntime.mark(signInWithEmail),_marked6=/*#__PURE__*/_regeneratorRuntime.mark(isUserAuthenticated),_marked7=/*#__PURE__*/_regeneratorRuntime.mark(signOut),_marked8=/*#__PURE__*/_regeneratorRuntime.mark(onGoogleSignIn),_marked9=/*#__PURE__*/_regeneratorRuntime.mark(onEmailSignIn),_marked10=/*#__PURE__*/_regeneratorRuntime.mark(onCheckUserSession),_marked11=/*#__PURE__*/_regeneratorRuntime.mark(onSignOut),_marked12=/*#__PURE__*/_regeneratorRuntime.mark(onSignUp),_marked13=/*#__PURE__*/_regeneratorRuntime.mark(onSignUpSuccess),_marked14=/*#__PURE__*/_regeneratorRuntime.mark(userSagas);import{takeLatest,all,call,put}from\"redux-saga/effects\";import UserTypes from\"./user-types\";import{signinSuccess,signinFailure,signoutSuccess,signoutFailure,signupSuccess,signupFailure}from\"./user-actions\";import{signInWithPopup,googleProvider,authInstance,getDoc,createUserProfileDocument,createUserWithEmailAndPassword,signInWithEmailAndPassword,getCurrentUser}from\"../../firebase/firebase.utils\";///////////////////////////User Authentication////////////////////////////////\nfunction authenticateUser(userAuth,additionalData){var userRef,userSnapshot;return _regeneratorRuntime.wrap(function authenticateUser$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return call(createUserProfileDocument,userAuth,additionalData);case 3:userRef=_context.sent;_context.next=6;return getDoc(userRef);case 6:userSnapshot=_context.sent;_context.next=9;return put(signinSuccess(_objectSpread({id:userSnapshot.id},userSnapshot.data())));case 9:_context.next=15;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);_context.next=15;return put(signinFailure(_context.t0));case 15:case\"end\":return _context.stop();}}},_marked,null,[[0,11]]);}///////////////////////////SignUp Code////////////////////////////////\nfunction signUpSuccess(_ref){var _ref$payload,userAuth,additionalData;return _regeneratorRuntime.wrap(function signUpSuccess$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_ref$payload=_ref.payload,userAuth=_ref$payload.userAuth,additionalData=_ref$payload.additionalData;_context2.next=3;return authenticateUser(userAuth,additionalData);case 3:case\"end\":return _context2.stop();}}},_marked2);}function signUp(_ref2){var _ref2$payload,email,password,displayName,_yield$createUserWith,user;return _regeneratorRuntime.wrap(function signUp$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_ref2$payload=_ref2.payload,email=_ref2$payload.email,password=_ref2$payload.password,displayName=_ref2$payload.displayName;_context3.prev=1;_context3.next=4;return createUserWithEmailAndPassword(authInstance,email,password);case 4:_yield$createUserWith=_context3.sent;user=_yield$createUserWith.user;_context3.next=8;return put(signupSuccess({userAuth:user,additionalData:{displayName:displayName}}));case 8:_context3.next=14;break;case 10:_context3.prev=10;_context3.t0=_context3[\"catch\"](1);_context3.next=14;return put(signupFailure(_context3.t0));case 14:case\"end\":return _context3.stop();}}},_marked3,null,[[1,10]]);}///////////////////////////SignIn and SignOut Code//////////////////////////////\nfunction signInWithGoogle(){var _yield$signInWithPopu,user;return _regeneratorRuntime.wrap(function signInWithGoogle$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return signInWithPopup(authInstance,googleProvider);case 3:_yield$signInWithPopu=_context4.sent;user=_yield$signInWithPopu.user;_context4.next=7;return authenticateUser(user);case 7:_context4.next=13;break;case 9:_context4.prev=9;_context4.t0=_context4[\"catch\"](0);_context4.next=13;return put(signinFailure(_context4.t0));case 13:case\"end\":return _context4.stop();}}},_marked4,null,[[0,9]]);}function signInWithEmail(_ref3){var _ref3$payload,email,password,_yield$signInWithEmai,user;return _regeneratorRuntime.wrap(function signInWithEmail$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_ref3$payload=_ref3.payload,email=_ref3$payload.email,password=_ref3$payload.password;_context5.prev=1;_context5.next=4;return signInWithEmailAndPassword(authInstance,email,password);case 4:_yield$signInWithEmai=_context5.sent;user=_yield$signInWithEmai.user;_context5.next=8;return authenticateUser(user);case 8:_context5.next=14;break;case 10:_context5.prev=10;_context5.t0=_context5[\"catch\"](1);_context5.next=14;return put(signinFailure(_context5.t0));case 14:case\"end\":return _context5.stop();}}},_marked5,null,[[1,10]]);}function isUserAuthenticated(){var userAuth;return _regeneratorRuntime.wrap(function isUserAuthenticated$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;_context6.next=3;return getCurrentUser();case 3:userAuth=_context6.sent;if(userAuth){_context6.next=6;break;}return _context6.abrupt(\"return\");case 6:_context6.next=8;return authenticateUser(userAuth);case 8:_context6.next=14;break;case 10:_context6.prev=10;_context6.t0=_context6[\"catch\"](0);_context6.next=14;return put(signinFailure(_context6.t0));case 14:case\"end\":return _context6.stop();}}},_marked6,null,[[0,10]]);}function signOut(){return _regeneratorRuntime.wrap(function signOut$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.prev=0;_context7.next=3;return authInstance.signOut();case 3:_context7.next=5;return put(signoutSuccess());case 5:_context7.next=11;break;case 7:_context7.prev=7;_context7.t0=_context7[\"catch\"](0);_context7.next=11;return put(signoutFailure(_context7.t0));case 11:case\"end\":return _context7.stop();}}},_marked7,null,[[0,7]]);}///////////////////////////Sagas/////////////////////////////////////////\nfunction onGoogleSignIn(){return _regeneratorRuntime.wrap(function onGoogleSignIn$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.next=2;return takeLatest(UserTypes.GOOGLE_SIGNIN_START,signInWithGoogle);case 2:case\"end\":return _context8.stop();}}},_marked8);}function onEmailSignIn(){return _regeneratorRuntime.wrap(function onEmailSignIn$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.next=2;return takeLatest(UserTypes.EMAIL_SIGNIN_START,signInWithEmail);case 2:case\"end\":return _context9.stop();}}},_marked9);}function onCheckUserSession(){return _regeneratorRuntime.wrap(function onCheckUserSession$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_context10.next=2;return takeLatest(UserTypes.CHECK_USER_SESSION,isUserAuthenticated);case 2:case\"end\":return _context10.stop();}}},_marked10);}function onSignOut(){return _regeneratorRuntime.wrap(function onSignOut$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:_context11.next=2;return takeLatest(UserTypes.SIGNOUT_START,signOut);case 2:case\"end\":return _context11.stop();}}},_marked11);}function onSignUp(){return _regeneratorRuntime.wrap(function onSignUp$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:_context12.next=2;return takeLatest(UserTypes.SIGNUP_START,signUp);case 2:case\"end\":return _context12.stop();}}},_marked12);}function onSignUpSuccess(){return _regeneratorRuntime.wrap(function onSignUpSuccess$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:_context13.next=2;return takeLatest(UserTypes.SIGNUP_SUCCESS,signUpSuccess);case 2:case\"end\":return _context13.stop();}}},_marked13);}function userSagas(){return _regeneratorRuntime.wrap(function userSagas$(_context14){while(1){switch(_context14.prev=_context14.next){case 0:_context14.next=2;return all([call(onGoogleSignIn),call(onEmailSignIn),call(onCheckUserSession),call(onSignOut),call(onSignUp),call(onSignUpSuccess)]);case 2:case\"end\":return _context14.stop();}}},_marked14);}export default userSagas;","map":{"version":3,"sources":["C:/Users/Acer/Desktop/Projects/React/ecommerce-app/client/src/redux/user/user-sagas.js"],"names":["authenticateUser","signUpSuccess","signUp","signInWithGoogle","signInWithEmail","isUserAuthenticated","signOut","onGoogleSignIn","onEmailSignIn","onCheckUserSession","onSignOut","onSignUp","onSignUpSuccess","userSagas","takeLatest","all","call","put","UserTypes","signinSuccess","signinFailure","signoutSuccess","signoutFailure","signupSuccess","signupFailure","signInWithPopup","googleProvider","authInstance","getDoc","createUserProfileDocument","createUserWithEmailAndPassword","signInWithEmailAndPassword","getCurrentUser","userAuth","additionalData","userRef","userSnapshot","id","data","payload","email","password","displayName","user","GOOGLE_SIGNIN_START","EMAIL_SIGNIN_START","CHECK_USER_SESSION","SIGNOUT_START","SIGNUP_START","SIGNUP_SUCCESS"],"mappings":"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","sourcesContent":["import { takeLatest, all, call, put } from \"redux-saga/effects\";\r\nimport UserTypes from \"./user-types\";\r\nimport {\r\n  signinSuccess,\r\n  signinFailure,\r\n  signoutSuccess,\r\n  signoutFailure,\r\n  signupSuccess,\r\n  signupFailure,\r\n} from \"./user-actions\";\r\n\r\nimport {\r\n  signInWithPopup,\r\n  googleProvider,\r\n  authInstance,\r\n  getDoc,\r\n  createUserProfileDocument,\r\n  createUserWithEmailAndPassword,\r\n  signInWithEmailAndPassword,\r\n  getCurrentUser,\r\n} from \"../../firebase/firebase.utils\";\r\n\r\n///////////////////////////User Authentication////////////////////////////////\r\n\r\nfunction* authenticateUser(userAuth, additionalData) {\r\n  try {\r\n    const userRef = yield call(\r\n      createUserProfileDocument,\r\n      userAuth,\r\n      additionalData\r\n    );\r\n    const userSnapshot = yield getDoc(userRef);\r\n    yield put(\r\n      signinSuccess({\r\n        id: userSnapshot.id,\r\n        ...userSnapshot.data(),\r\n      })\r\n    );\r\n  } catch (error) {\r\n    yield put(signinFailure(error));\r\n  }\r\n}\r\n\r\n///////////////////////////SignUp Code////////////////////////////////\r\n\r\nfunction* signUpSuccess({ payload: { userAuth, additionalData } }) {\r\n  yield authenticateUser(userAuth, additionalData);\r\n}\r\n\r\nfunction* signUp({ payload: { email, password, displayName } }) {\r\n  try {\r\n    const { user } = yield createUserWithEmailAndPassword(\r\n      authInstance,\r\n      email,\r\n      password\r\n    );\r\n    yield put(\r\n      signupSuccess({ userAuth: user, additionalData: { displayName } })\r\n    );\r\n  } catch (error) {\r\n    yield put(signupFailure(error));\r\n  }\r\n}\r\n\r\n///////////////////////////SignIn and SignOut Code//////////////////////////////\r\n\r\nfunction* signInWithGoogle() {\r\n  try {\r\n    const { user } = yield signInWithPopup(authInstance, googleProvider);\r\n    yield authenticateUser(user);\r\n  } catch (error) {\r\n    yield put(signinFailure(error));\r\n  }\r\n}\r\n\r\nfunction* signInWithEmail({ payload: { email, password } }) {\r\n  try {\r\n    const { user } = yield signInWithEmailAndPassword(\r\n      authInstance,\r\n      email,\r\n      password\r\n    );\r\n    yield authenticateUser(user);\r\n  } catch (error) {\r\n    yield put(signinFailure(error));\r\n  }\r\n}\r\n\r\nfunction* isUserAuthenticated() {\r\n  try {\r\n    const userAuth = yield getCurrentUser();\r\n    if (!userAuth) return;\r\n    yield authenticateUser(userAuth);\r\n  } catch (error) {\r\n    yield put(signinFailure(error));\r\n  }\r\n}\r\n\r\nfunction* signOut() {\r\n  try {\r\n    yield authInstance.signOut();\r\n    yield put(signoutSuccess());\r\n  } catch (error) {\r\n    yield put(signoutFailure(error));\r\n  }\r\n}\r\n\r\n///////////////////////////Sagas/////////////////////////////////////////\r\n\r\nfunction* onGoogleSignIn() {\r\n  yield takeLatest(UserTypes.GOOGLE_SIGNIN_START, signInWithGoogle);\r\n}\r\n\r\nfunction* onEmailSignIn() {\r\n  yield takeLatest(UserTypes.EMAIL_SIGNIN_START, signInWithEmail);\r\n}\r\n\r\nfunction* onCheckUserSession() {\r\n  yield takeLatest(UserTypes.CHECK_USER_SESSION, isUserAuthenticated);\r\n}\r\n\r\nfunction* onSignOut() {\r\n  yield takeLatest(UserTypes.SIGNOUT_START, signOut);\r\n}\r\n\r\nfunction* onSignUp() {\r\n  yield takeLatest(UserTypes.SIGNUP_START, signUp);\r\n}\r\n\r\nfunction* onSignUpSuccess() {\r\n  yield takeLatest(UserTypes.SIGNUP_SUCCESS, signUpSuccess);\r\n}\r\n\r\nfunction* userSagas() {\r\n  yield all([\r\n    call(onGoogleSignIn),\r\n    call(onEmailSignIn),\r\n    call(onCheckUserSession),\r\n    call(onSignOut),\r\n    call(onSignUp),\r\n    call(onSignUpSuccess),\r\n  ]);\r\n}\r\n\r\nexport default userSagas;\r\n"]},"metadata":{},"sourceType":"module"}